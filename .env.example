# ====================================================================
# CONFIGURATION D'ENVIRONNEMENT EPERCEPT - Variables unifi√©es
# ====================================================================
# Fichier de r√©f√©rence consolidant toutes les variables d'environnement
# n√©cessaires pour l'application Epercept (Documents 3, 4, 5, 6, 7)
# 
# Instructions :
# 1. Copier ce fichier vers .env (backend) et .env.local (frontend)
# 2. Remplacer les valeurs exemple par vos vraies configurations
# 3. Ne jamais committer les fichiers .env avec des vraies valeurs
# ====================================================================

# ====================================================================
# üåç ENVIRONNEMENT ET CONFIGURATION G√âN√âRALE
# ====================================================================
NODE_ENV=development                # development | staging | production
APP_NAME=Epercept
APP_VERSION=1.0.0

# ====================================================================
# üöÄ SERVEUR BACKEND (NestJS)
# ====================================================================
# Configuration du serveur principal
PORT=3001                          # Port d'√©coute du serveur NestJS
HOST=0.0.0.0                      # Interface d'√©coute (0.0.0.0 pour Docker)

# URLs de base
API_BASE_URL=http://localhost:3001  # URL de base de l'API
FRONTEND_URL=http://localhost:3000   # URL du frontend pour CORS

# ====================================================================
# üóÑÔ∏è BASE DE DONN√âES (PostgreSQL + Prisma)
# ====================================================================
# URL compl√®te de connexion PostgreSQL
DATABASE_URL=postgresql://epercept_user:secure_password@localhost:5432/epercept

# Configuration d√©taill√©e (optionnel si DATABASE_URL suffit)
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=epercept
DATABASE_USER=epercept_user
DATABASE_PASSWORD=secure_password
DATABASE_SSL=true                  # Activer SSL en production

# Pool de connexions pour performance
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10
DB_CONNECTION_LIMIT=10             # Limite Prisma

# ====================================================================
# üî¥ REDIS (Cache et Sessions)
# ====================================================================
# Configuration Redis principale
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=redis_password
REDIS_DB=0
REDIS_URL=redis://localhost:6379  # URL compl√®te alternative

# Configuration avanc√©e Redis
REDIS_KEY_PREFIX=epercept:         # Pr√©fixe pour toutes les cl√©s
REDIS_TTL=3600                     # TTL par d√©faut (1 heure)

# Redis Cluster (pour haute performance - Document 6)
REDIS_HOST_1=localhost
REDIS_PORT_1=6379
REDIS_HOST_2=localhost
REDIS_PORT_2=6380

# ====================================================================
# üîê S√âCURIT√â ET AUTHENTIFICATION
# ====================================================================
# JWT Configuration
JWT_SECRET=super_secure_jwt_secret_key_minimum_32_characters_required
JWT_EXPIRATION=24h                 # Dur√©e de vie des tokens
JWT_REFRESH_EXPIRATION=7d          # Dur√©e de vie des refresh tokens

# Encryption pour donn√©es sensibles
ENCRYPTION_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef

# Hash des mots de passe
BCRYPT_ROUNDS=12                   # Nombre de rounds bcrypt (s√©curit√©)

# Rate Limiting
RATE_LIMIT_TTL=60                  # Fen√™tre de temps (secondes)
RATE_LIMIT_LIMIT=100               # Nombre max de requ√™tes par fen√™tre

# CORS Configuration
CORS_ORIGINS=http://localhost:3000,https://epercept.com,https://app.epercept.com
WS_CORS_ORIGINS=http://localhost:3000,https://epercept.com,https://app.epercept.com

# ====================================================================
# üåê WEBSOCKET CONFIGURATION
# ====================================================================
# Configuration Socket.io
WS_MAX_CONNECTIONS=1000            # Nombre max de connexions simultan√©es
WS_HEARTBEAT_INTERVAL=30000        # Intervalle heartbeat (30s)
WS_CONNECTION_TIMEOUT=60000        # Timeout de connexion (60s)
WS_PING_TIMEOUT=60000              # Timeout ping
WS_PING_INTERVAL=25000             # Intervalle ping

# ====================================================================
# üìß SERVICES EXTERNES - EMAIL (SMTP)
# ====================================================================
# Configuration SMTP
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=noreply@epercept.com
SMTP_PASSWORD=smtp_password
SMTP_FROM=Epercept <noreply@epercept.com>
SMTP_SECURE=false                  # true pour port 465, false pour autres

# ====================================================================
# üìä MONITORING ET LOGGING
# ====================================================================
# Logging
LOG_LEVEL=info                     # error | warn | info | debug
LOG_FORMAT=json                    # json | simple
HEALTH_CHECK_ENDPOINT=/health

# Sentry (Error Tracking)
SENTRY_DSN=https://your-sentry-dsn-here@sentry.io/project-id

# Prometheus (M√©triques)
PROMETHEUS_PORT=9090
PROMETHEUS_ENDPOINT=/metrics

# Elasticsearch (Logs avanc√©s - production)
ELASTICSEARCH_URL=https://localhost:9200
ELASTICSEARCH_USER=elastic
ELASTICSEARCH_PASSWORD=elasticsearch_password

# ====================================================================
# üìÅ STOCKAGE ET FICHIERS
# ====================================================================
# Configuration uploads
UPLOAD_PATH=./uploads              # Chemin de stockage des fichiers
MAX_FILE_SIZE=10485760             # Taille max fichier (10MB)
ALLOWED_FILE_TYPES=.jpg,.jpeg,.png,.gif,.pdf

# ====================================================================
# üéõÔ∏è FEATURES FLAGS
# ====================================================================
# Activation/d√©sactivation de fonctionnalit√©s
ENABLE_REGISTRATION=true           # Permettre cr√©ation de comptes
ENABLE_EMAIL_VERIFICATION=true     # V√©rification email obligatoire
ENABLE_ANALYTICS=true              # Activation analytics
MAINTENANCE_MODE=false             # Mode maintenance

# ====================================================================
# üñ•Ô∏è FRONTEND (Next.js/Vite)
# ====================================================================
# Configuration application frontend
VITE_APP_NAME=Epercept
VITE_APP_VERSION=1.0.0
VITE_APP_ENV=development           # development | staging | production

# API Endpoints
VITE_API_BASE_URL=http://localhost:3001
NEXT_PUBLIC_API_URL=http://localhost:3001    # Next.js public var
VITE_WS_URL=ws://localhost:3001             # WebSocket URL
VITE_API_TIMEOUT=10000                      # Timeout API (10s)

# Features Frontend
VITE_ENABLE_DEV_TOOLS=true         # Outils de d√©veloppement
VITE_ENABLE_ANALYTICS=true         # Analytics frontend
VITE_ENABLE_ERROR_REPORTING=true   # Reporting d'erreurs
VITE_ENABLE_PWA=true               # Progressive Web App

# Services externes Frontend
VITE_GOOGLE_ANALYTICS_ID=GA_MEASUREMENT_ID
VITE_SENTRY_DSN=https://your-frontend-sentry-dsn@sentry.io/project-id
VITE_HOTJAR_ID=your_hotjar_id

# ====================================================================
# üì± PWA CONFIGURATION
# ====================================================================
# Configuration Progressive Web App
VITE_PWA_NAME=Epercept
VITE_PWA_SHORT_NAME=Epercept
VITE_PWA_DESCRIPTION=Jeu de quiz multijoueur en temps r√©el
VITE_PWA_THEME_COLOR=#1a1a1a
VITE_PWA_BACKGROUND_COLOR=#ffffff

# ====================================================================
# üîß BUILD ET D√âVELOPPEMENT
# ====================================================================
# Configuration build
VITE_BUILD_SOURCEMAP=false         # Source maps en production
VITE_BUILD_MINIFY=true             # Minification
VITE_BUILD_TARGET=es2020           # Target ES

# ====================================================================
# üê≥ DOCKER ET D√âPLOIEMENT
# ====================================================================
# Variables pour conteneurs Docker
DOCKER_REGISTRY=epercept
IMAGE_TAG=latest

# Variables de d√©ploiement sp√©cifiques
STAGING_DATABASE_URL=postgresql://staging-user:staging-pass@staging-host:5432/epercept_staging
STAGING_REDIS_HOST=staging-redis-host

# ====================================================================
# üõ†Ô∏è ADMINISTRATION ET MAINTENANCE
# ====================================================================
# Token admin pour scripts d'administration
ADMIN_JWT_TOKEN=admin-jwt-token-for-scripts

# Chemins de sauvegarde
BACKUP_DIR=/backups/epercept
LOG_DIR=/var/log/epercept

# ====================================================================
# üìà PERFORMANCE ET OPTIMISATION
# ====================================================================
# Configuration cache avanc√©
CACHE_TTL_SHORT=300                # 5 minutes
CACHE_TTL_MEDIUM=3600              # 1 heure  
CACHE_TTL_LONG=86400               # 24 heures

# Optimisations WebSocket
WS_COMPRESSION=true                # Compression des messages
WS_MAX_MESSAGE_SIZE=1048576        # Taille max message (1MB)

# ====================================================================
# üîç VARIABLES DE DEBUG ET TESTS
# ====================================================================
# Debug et d√©veloppement
DEBUG_SQL=false                    # Afficher requ√™tes SQL
DEBUG_WEBSOCKET=false              # Debug WebSocket
MOCK_EXTERNAL_SERVICES=false       # Mocker services externes en test

# Tests
TEST_DATABASE_URL=postgresql://test_user:test_pass@localhost:5432/epercept_test
TEST_REDIS_URL=redis://localhost:6380/1

# ====================================================================
# üåç VARIABLES PAR ENVIRONNEMENT
# ====================================================================

# D√âVELOPPEMENT (overrides pour d√©veloppement local)
# D√©commenter selon besoin :
# NODE_ENV=development
# LOG_LEVEL=debug
# VITE_ENABLE_DEV_TOOLS=true
# DEBUG_SQL=true

# STAGING (overrides pour environnement de test)
# NODE_ENV=staging
# DATABASE_URL=${STAGING_DATABASE_URL}
# API_BASE_URL=https://api-staging.epercept.com

# PRODUCTION (overrides pour production)
# NODE_ENV=production
# LOG_LEVEL=warn
# VITE_ENABLE_DEV_TOOLS=false
# DEBUG_SQL=false
# CORS_ORIGINS=https://epercept.com,https://app.epercept.com